<html>
  <head>
    <script src="d3.v3.min.js"></script>
    <script src="flareplot-main.js"></script>
    <script src="flare_view.js"></script>
    <script src="flareplot-rangeslider.js"></script>

    <link href="flareplot-main.css" rel="stylesheet" />
    <link href="flareplot-fingerprintpanel.css" rel="stylesheet" />
    <link href="flareplot-rangeslider.css" rel="stylesheet"/>


    <style>
      body {
        display: flex;
        align-items: center;
        justify-content: center;
      }

      #div-container {
        display: flex;
        flex-direction: column;
        gap: 2rem;
        justify-content: center;
        align-items: center;
      }
    </style>
  </head>
  <body>
    <div id="div-container">
      <div id="flare-container"></div>
    <div id="slider-container" style="width:900px;height:40px"></div>
    </div>
    <script>
      const jsonData = window.parent.extensionData["flareplotJSONData"];
      const flareData = JSON.parse(jsonData);

      // Get window size
      const w = window.parent.innerWidth / 3;

      const plot = createFlareplot(`${w}`, flareData, "#flare-container");
      createFlareplotSlider(plot, "#slider-container");

      plot.addNodeToggleListener(async (e) => {
        console.log(e);
        // Get chain and residue number
        const splitted = e.name.split(":");
        const chain = splitted[0];
        const resNum = Number(splitted[2]);
        result = await parent.molstar.focus(undefined, resNum, chain);
      });
    </script>
  </body>
</html>
